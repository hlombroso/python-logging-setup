version: 1

disable_existing_loggers: False

formatters:
  # Note about formats: https://docs.python.org/3/library/logging.html#logrecord-attributes
  consoleFormatter:
    format: "%(asctime)s - %(levelname)-8s : %(message)s"
  fileFormatter:
    format: "%(asctime)s - %(name)s - %(levelname)-8s : %(message)s"
  errorFormatter:
    format: "%(asctime)s,%(msecs)03d - %(levelname)s - [%(pathname)s:%(lineno)d in function %(funcName)s] : %(message)s"
    datefmt: "%Y-%m-%d %H:%M:%S"

handlers:
  consoleHandler:
    class: logging.StreamHandler
    level: DEBUG
    formatter: consoleFormatter
    stream: ext://sys.stdout
  fileHandler:
    class: logging.FileHandler
    level: DEBUG
    formatter: fileFormatter
    filename: "app.log"
  rotatingFileHandler:
    class: logging.handlers.RotatingFileHandler
    level: DEBUG
    formatter: fileFormatter
    filename: "app.log"
    maxBytes: 1024
    backupCount: 10
  timedRotatingFileHandler:
    class: logging.handlers.TimedRotatingFileHandler
    level: DEBUG
    formatter: fileFormatter
    filename: "app.log"
    when: "MIDNIGHT"
    backupCount: 360
  emailHandler:
    class: logging.handlers.SMTPHandler
    mailhost: (smtp.example.com, 25)
    credentials: (user_id,passwd)
    fromaddr: noreply@example.com
    toaddrs:
      - recipient1@example.com
      - recipient2@example.com
    subject: "App in error"
  errorTimedRotatingFileHandler:
    class: logging.handlers.TimedRotatingFileHandler
    level: DEBUG
    formatter: errorFormatter
    filename: app.log
    when: "MIDNIGHT"
    backupCount: 360
  errorOnlyTimedRotatingFileHandler:
    class: logging.handlers.TimedRotatingFileHandler
    level: DEBUG
    formatter: errorFormatter
    filename: error.log
    when: "MIDNIGHT"
    backupCount: 360

root:
  handlers: [consoleHandler, timedRotatingFileHandler]
  level: DEBUG
  propagate: False

loggers:
  dev:
    handlers: [consoleHandler, fileHandler]
    level: DEBUG
    propagate: False
  prod:
    handlers: [consoleHandler, timedRotatingFileHandler]
    level: DEBUG
    propagate: False
  error:
    handlers: [consoleHandler, errorTimedRotatingFileHandler]
    level: DEBUG
    propagate: False
  errorOnly:
    handlers: [errorOnlyTimedRotatingFileHandler]
    level: DEBUG
    propagate: False
  email:
    handlers: [emailHandler]
    level: DEBUG
    propagate: False
